!function(){"use strict";var t={};function r(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function e(t,e){if(t){if("string"===typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}function n(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,a,o=[],i=!0,u=!1;try{for(e=e.call(t);!(i=(n=e.next()).done)&&(o.push(n.value),!r||o.length!==r);i=!0);}catch(c){u=!0,a=c}finally{try{i||null==e.return||e.return()}finally{if(u)throw a}}return o}}(t,r)||e(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function o(t,r){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},o(t,r)}function i(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function u(t,r,e){return u=i()?Reflect.construct.bind():function(t,r,e){var n=[null];n.push.apply(n,r);var a=new(Function.bind.apply(t,n));return e&&o(a,e.prototype),a},u.apply(null,arguments)}function c(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||e(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var l=Symbol("Comlink.proxy"),s=Symbol("Comlink.endpoint"),p=Symbol("Comlink.releaseProxy"),f=Symbol("Comlink.thrown"),d=function(t){return"object"===typeof t&&null!==t||"function"===typeof t},y=new Map([["proxy",{canHandle:function(t){return d(t)&&t[l]},serialize:function(t){var r=new MessageChannel,e=r.port1,n=r.port2;return h(t,e),[n,[n]]},deserialize:function(t){return t.start(),b(t,[],r);var r}}],["throw",{canHandle:function(t){return d(t)&&f in t},serialize:function(t){var r=t.value;return[r instanceof Error?{isError:!0,value:{message:r.message,name:r.name,stack:r.stack}}:{isError:!1,value:r},[]]},deserialize:function(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}}]]);function h(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:self;r.addEventListener("message",(function e(o){if(o&&o.data){var i,l=Object.assign({path:[]},o.data),s=l.id,p=l.type,d=l.path,y=(o.data.argumentList||[]).map(O);try{var v=d.slice(0,-1).reduce((function(t,r){return t[r]}),t),b=d.reduce((function(t,r){return t[r]}),t);switch(p){case"GET":i=b;break;case"SET":v[d.slice(-1)[0]]=O(o.data.value),i=!0;break;case"APPLY":i=b.apply(v,y);break;case"CONSTRUCT":var g;i=E(u(b,c(y)));break;case"ENDPOINT":var w=new MessageChannel,S=w.port1,j=w.port2;h(t,j),i=A(S,[S]);break;case"RELEASE":i=void 0;break;default:return}}catch(g){i=a({value:g},f,0)}Promise.resolve(i).catch((function(t){return a({value:t},f,0)})).then((function(t){var a=n(x(t),2),o=a[0],i=a[1];r.postMessage(Object.assign(Object.assign({},o),{id:s}),i),"RELEASE"===p&&(r.removeEventListener("message",e),m(r))}))}})),r.start&&r.start()}function m(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function v(t){if(t)throw new Error("Proxy has been released and is not useable")}function b(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=!1,o=new Proxy(e,{get:function(e,n){if(v(a),n===p)return function(){return S(t,{type:"RELEASE",path:r.map((function(t){return t.toString()}))}).then((function(){m(t),a=!0}))};if("then"===n){if(0===r.length)return{then:function(){return o}};var i=S(t,{type:"GET",path:r.map((function(t){return t.toString()}))}).then(O);return i.then.bind(i)}return b(t,[].concat(c(r),[n]))},set:function(e,o,i){v(a);var u=n(x(i),2),l=u[0],s=u[1];return S(t,{type:"SET",path:[].concat(c(r),[o]).map((function(t){return t.toString()})),value:l},s).then(O)},apply:function(e,o,i){v(a);var u=r[r.length-1];if(u===s)return S(t,{type:"ENDPOINT"}).then(O);if("bind"===u)return b(t,r.slice(0,-1));var c=n(g(i),2),l=c[0],p=c[1];return S(t,{type:"APPLY",path:r.map((function(t){return t.toString()})),argumentList:l},p).then(O)},construct:function(e,o){v(a);var i=n(g(o),2),u=i[0],c=i[1];return S(t,{type:"CONSTRUCT",path:r.map((function(t){return t.toString()})),argumentList:u},c).then(O)}});return o}function g(t){var r,e=t.map(x);return[e.map((function(t){return t[0]})),(r=e.map((function(t){return t[1]})),Array.prototype.concat.apply([],r))]}var w=new WeakMap;function A(t,r){return w.set(t,r),t}function E(t){return Object.assign(t,a({},l,!0))}function x(t){var r,a=function(t,r){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=e(t))||r&&t&&"number"===typeof t.length){n&&(t=n);var a=0,o=function(){};return{s:o,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return u=t.done,t},e:function(t){c=!0,i=t},f:function(){try{u||null==n.return||n.return()}finally{if(c)throw i}}}}(y);try{for(a.s();!(r=a.n()).done;){var o=n(r.value,2),i=o[0],u=o[1];if(u.canHandle(t)){var c=n(u.serialize(t),2);return[{type:"HANDLER",name:i,value:c[0]},c[1]]}}}catch(l){a.e(l)}finally{a.f()}return[{type:"RAW",value:t},w.get(t)||[]]}function O(t){switch(t.type){case"HANDLER":return y.get(t.name).deserialize(t.value);case"RAW":return t.value}}function S(t,r,e){return new Promise((function(n){var a=new Array(4).fill(0).map((function(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)})).join("-");t.addEventListener("message",(function r(e){e.data&&e.data.id&&e.data.id===a&&(t.removeEventListener("message",r),n(e.data))})),t.start&&t.start(),t.postMessage(Object.assign({id:a},r),e)}))}function j(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function C(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?j(Object(e),!0).forEach((function(r){a(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):j(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}function N(t){return"".concat(t.val,"|").concat(t.boundName)}function P(t,r){var e;if(!r.has(N(t)))return t;for(var n=C(C({},t),{},{boundName:null!==(e=t.boundName)&&void 0!==e?e:1});r.has(N(n));)n.boundName+=1;return n}function R(t){if("empty_program"===t.type)return[];var r=[],e=new Set,n=[];return function t(a){switch(a.type){case"name":var o=N(a);return void(n.includes(o)||e.has(o)||(r.push(a),e.add(o)));case"lambda":return n.push(N(a.var)),t(a.body),void n.pop();case"application":return void a.body.forEach((function(r){return t(r)}))}}(t),r}function M(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("empty_program"===t.type)return t;var e=r.replaceNameWithT,n=void 0===e||e,a=r.startIndex,o=void 0===a?1:a,i=[],u={},c=R(t),l=new Set(c.map((function(t){return N(t)}))),s=o;function p(t){switch(t.type){case"name":var r=N(t);if(i.includes(r)){var e,a=null!==(e=u[r])&&void 0!==e?e:[],o=a[a.length-1];if(null==o)throw new Error("The var with mangled name ".concat(r," is listed as a bound variable, by entry in the rename map for it was found."));return C({},o)}return t;case"lambda":var c=N(t.var);i.push(c);var f=P({type:"name",val:n?"t":t.var.val,boundName:s},l);l.add(N(f)),u[c]=u[c]||[],u[c].push(f),s++;var d={type:"lambda",var:f,body:p(t.body)};return u[c].pop(),i.pop(),d;case"application":return{type:"application",body:t.body.map((function(t){return p(t)}))}}}return p(t)}var k="\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089".split("");function T(t){switch(t.type){case"empty_program":return"";case"name":return _(t);case"lambda":return"\u03bb".concat(T(t.var),".").concat(T(t.body));case"application":return t.body.map((function(t){var r=T(t);return"lambda"===t.type||"application"===t.type?"(".concat(r,")"):r})).join(" ")}}function _(t){return null!=t.boundName?t.val+function(t){return String(t).split("").map((function(t){var r=Number(t);if(r>=0)return k[r];throw new Error('This function can only be used to print integers, not "'.concat(t,'"'))})).join("")}(Number(t.boundName)):t.val}function L(t){return"empty_program"===t.type?"":T(t=M(t))}function I(t,r,e){function n(t){return"name"===t.type&&(t.val===r.val&&t.boundName===r.boundName)}var a=D(t);return function t(o){switch(o.type){case"name":if(n(o)){var i=M(e,{replaceNameWithT:!1,startIndex:a});return a=Math.max(a,D(i)),i}return o;case"lambda":if(n(o.var))throw new Error("Cannot replace variable ".concat(T(r)," since it appears as the variable name in the lambda ").concat(T(o)));var u=M(C(C({},o),{},{body:t(o.body)}),{replaceNameWithT:!1,startIndex:a});return a=Math.max(a,D(u)),u;case"application":var c=M({type:"application",body:o.body.map((function(r){return t(r)}))},{replaceNameWithT:!1,startIndex:a});return a=Math.max(a,D(c)),c}}(t)}function D(t){switch(t.type){case"empty_program":return 0;case"name":return t.boundName||0;case"lambda":return Math.max(D(t.var),D(t.body));case"application":return Array.isArray(t.body)?Math.max.apply(Math,c(t.body.map((function(t){return D(t)})))):D(t.body)}}var F=function(){function t(r,e,n,a){var o=Error.call(this,r);return Object.setPrototypeOf&&Object.setPrototypeOf(o,t.prototype),o.expected=e,o.found=n,o.location=a,o.name="SyntaxError",o}function r(t,r,e){return e=e||" ",t.length>r?t:(r-=t.length,t+(e+=e.repeat(r)).slice(0,r))}return function(t,r){function e(){this.constructor=t}e.prototype=r.prototype,t.prototype=new e}(t,Error),t.prototype.format=function(t){var e="Error: "+this.message;if(this.location){var n,a=null;for(n=0;n<t.length;n++)if(t[n].source===this.location.source){a=t[n].text.split(/\r\n|\n|\r/g);break}var o=this.location.start,i=this.location.source+":"+o.line+":"+o.column;if(a){var u=this.location.end,c=r("",o.line.toString().length," "),l=a[o.line-1],s=(o.line===u.line?u.column:l.length+1)-o.column||1;e+="\n --\x3e "+i+"\n"+c+" |\n"+o.line+" | "+l+"\n"+c+" | "+r("",o.column-1," ")+r("",s,"^")}else e+="\n at "+i}return e},t.buildMessage=function(t,r){var e,n={literal:function(t){return'"'+o(t.text)+'"'},class:function(t){var r=t.parts.map((function(t){return Array.isArray(t)?i(t[0])+"-"+i(t[1]):i(t)}));return"["+(t.inverted?"^":"")+r.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};function a(t){return t.charCodeAt(0).toString(16).toUpperCase()}function o(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+a(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+a(t)}))}function i(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+a(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+a(t)}))}function u(t){return n[t.type](t)}return"Expected "+function(t){var r,e,n=t.map(u);if(n.sort(),n.length>0){for(r=1,e=1;r<n.length;r++)n[r-1]!==n[r]&&(n[e]=n[r],e++);n.length=e}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(t)+" but "+(((e=r)?'"'+o(e)+'"':"end of input")+" found.")},{SyntaxError:t,parse:function(r,e){var n,a={},o=(e=void 0!==e?e:{}).grammarSource,i={program:Q},u=Q,l="lambda",s="//",p=/^[ \t\n\r]/,f=/^[a-zA-Z0-9_]/,d=/^[\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089]/,y=/^[ \t]/,h=Z("program"),m=Z("expression"),v=Z("application"),b=J("(",!1),g=J(")",!1),w=Z("inner_function"),A=J(".",!1),E=Y([" ","\t","\n","\r"],!1,!1),x=Z("name"),O=Y([["a","z"],["A","Z"],["0","9"],"_"],!1,!1),S=Y(["\u2080","\u2081","\u2082","\u2083","\u2084","\u2085","\u2086","\u2087","\u2088","\u2089"],!1,!1),j=Z("lambda"),C=J("\\",!1),N=J("\u03bb",!1),P=J("lambda",!1),R=Z("comment_or_whitespace"),M=Z("whitespace"),k=Z("comment"),T=Y([" ","\t"],!1,!1),_=J("//",!1),L={type:"any"},I=J("\n",!1),D=function(t,r){return[r]},F=function(t,r){return r},z=function(t){return!"\n\r".includes(t)},W=0,H=[{line:1,column:1}],U=0,G=[],B=0;if("startRule"in e){if(!(e.startRule in i))throw new Error("Can't start parsing from rule \""+e.startRule+'".');u=i[e.startRule]}function J(t,r){return{type:"literal",text:t,ignoreCase:r}}function Y(t,r,e){return{type:"class",parts:t,inverted:r,ignoreCase:e}}function Z(t){return{type:"other",description:t}}function X(t){var e,n=H[t];if(n)return n;for(e=t-1;!H[e];)e--;for(n={line:(n=H[e]).line,column:n.column};e<t;)10===r.charCodeAt(e)?(n.line++,n.column=1):n.column++,e++;return H[t]=n,n}function $(t,r){var e=X(t),n=X(r);return{source:o,start:{offset:t,line:e.line,column:e.column},end:{offset:r,line:n.line,column:n.column}}}function q(t){W<U||(W>U&&(U=W,G=[]),G.push(t))}function K(r,e,n){return new t(t.buildMessage(r,e),r,e,n)}function Q(){var t,r;return B++,t=W,at()!==a&&(r=V())!==a&&at()!==a?(t,t=r):(W=t,t=a),t===a&&(t=W,at()!==a&&(r=it())!==a?(t,t=void 0):(W=t,t=a)),B--,t===a&&(a,0===B&&q(h)),t}function V(){var t;return B++,(t=function(){var t;B++,(t=rt())===a&&(t=tt());B--,t===a&&(a,0===B&&q(v));return t}())===a&&(t=et())===a&&(t=nt()),B--,t===a&&(a,0===B&&q(m)),t}function tt(){var t,e,n,o;return t=W,40===r.charCodeAt(W)?(e="(",W++):(e=a,0===B&&q(b)),e!==a&&(n=rt())!==a?(41===r.charCodeAt(W)?(o=")",W++):(o=a,0===B&&q(g)),o!==a?(t,t=n):(W=t,t=a)):(W=t,t=a),t}function rt(){var t,r,e,n,o,i;if(t=W,at()!==a)if((r=et())===a&&(r=nt())===a&&(r=tt()),r!==a)if(at()!==a){if(e=[],n=W,at()!==a?(o=W,(i=tt())!==a&&(o,i=D(0,i)),(o=i)===a&&(o=V()),o!==a?(n,n=F(0,o)):(W=n,n=a)):(W=n,n=a),n!==a)for(;n!==a;)e.push(n),n=W,at()!==a?(o=W,(i=tt())!==a&&(o,i=D(0,i)),(o=i)===a&&(o=V()),o!==a?(n,n=F(0,o)):(W=n,n=a)):(W=n,n=a);else e=a;e!==a&&(n=at())!==a?(t,t=function(t,r){var e;return(e=[t]).concat.apply(e,c(r))}(r,e)):(W=t,t=a)}else W=t,t=a;else W=t,t=a;else W=t,t=a;return t}function et(){var t,e,n,o;return t=function(){var t,e,n,o,i,u,c;if(B++,t=W,e=function(){var t;B++,92===r.charCodeAt(W)?(t="\\",W++):(t=a,0===B&&q(C));t===a&&(955===r.charCodeAt(W)?(t="\u03bb",W++):(t=a,0===B&&q(N)),t===a&&(r.substr(W,6)===l?(t=l,W+=6):(t=a,0===B&&q(P))));B--,t===a&&(a,0===B&&q(j));return t}(),e!==a)if(at()!==a)if((n=nt())!==a){if(o=W,(i=at())!==a?(46===r.charCodeAt(W)?(u=".",W++):(u=a,0===B&&q(A)),u!==a&&(c=at())!==a?o=i=[i,u,c]:(W=o,o=a)):(W=o,o=a),o===a)if(o=[],p.test(r.charAt(W))?(i=r.charAt(W),W++):(i=a,0===B&&q(E)),i!==a)for(;i!==a;)o.push(i),p.test(r.charAt(W))?(i=r.charAt(W),W++):(i=a,0===B&&q(E));else o=a;o!==a&&(i=at())!==a&&(u=V())!==a&&(c=at())!==a?(t,t={type:"lambda",var:n,body:u}):(W=t,t=a)}else W=t,t=a;else W=t,t=a;else W=t,t=a;B--,t===a&&(e=a,0===B&&q(w));return t}(),t===a&&(t=W,40===r.charCodeAt(W)?(e="(",W++):(e=a,0===B&&q(b)),e!==a&&at()!==a&&(n=et())!==a&&at()!==a?(41===r.charCodeAt(W)?(o=")",W++):(o=a,0===B&&q(g)),o!==a?(t,t=n):(W=t,t=a)):(W=t,t=a)),t}function nt(){var t,e,n,o;return t=function(){var t,e,n,o,i,u;B++,t=W,e=W,n=W,o=[],f.test(r.charAt(W))?(i=r.charAt(W),W++):(i=a,0===B&&q(O));if(i!==a)for(;i!==a;)o.push(i),f.test(r.charAt(W))?(i=r.charAt(W),W++):(i=a,0===B&&q(O));else o=a;n=o!==a?r.substring(n,W):o;if(n!==a){if(o=W,i=[],d.test(r.charAt(W))?(u=r.charAt(W),W++):(u=a,0===B&&q(S)),u!==a)for(;u!==a;)i.push(u),d.test(r.charAt(W))?(u=r.charAt(W),W++):(u=a,0===B&&q(S));else i=a;(o=i!==a?r.substring(o,W):i)===a&&(o=null),e=n=[n,o]}else W=e,e=a;t=e!==a?r.substring(t,W):e;B--,t===a&&(e=a,0===B&&q(x));return t}(),t===a&&(t=W,40===r.charCodeAt(W)?(e="(",W++):(e=a,0===B&&q(b)),e!==a&&at()!==a&&(n=nt())!==a&&at()!==a?(41===r.charCodeAt(W)?(o=")",W++):(o=a,0===B&&q(g)),o!==a?(t,t=n):(W=t,t=a)):(W=t,t=a)),t}function at(){var t;return B++,t=function(){var t,e,n,o,i,u,c,l;B++,t=W,e=[],y.test(r.charAt(W))?(n=r.charAt(W),W++):(n=a,0===B&&q(T));for(;n!==a;)e.push(n),y.test(r.charAt(W))?(n=r.charAt(W),W++):(n=a,0===B&&q(T));r.substr(W,2)===s?(n=s,W+=2):(n=a,0===B&&q(_));if(n!==a){for(o=[],i=W,r.length>W?(u=r.charAt(W),W++):(u=a,0===B&&q(L)),u!==a?(W,(c=(c=z(u))?void 0:a)!==a?i=u=[u,c]:(W=i,i=a)):(W=i,i=a);i!==a;)o.push(i),i=W,r.length>W?(u=r.charAt(W),W++):(u=a,0===B&&q(L)),u!==a?(W,(c=(c=z(u))?void 0:a)!==a?i=u=[u,c]:(W=i,i=a)):(W=i,i=a);i=W,10===r.charCodeAt(W)?(u="\n",W++):(u=a,0===B&&q(I)),u!==a?(c=ot(),(l=at())!==a?i=u=[u,c,l]:(W=i,i=a)):(W=i,i=a),i===a&&(i=it()),i!==a?t=e=[e,n,o,i]:(W=t,t=a)}else W=t,t=a;B--,t===a&&(e=a,0===B&&q(k));return t}(),t===a&&(t=ot()),B--,t===a&&(a,0===B&&q(R)),t}function ot(){var t,e;for(B++,t=[],p.test(r.charAt(W))?(e=r.charAt(W),W++):(e=a,0===B&&q(E));e!==a;)t.push(e),p.test(r.charAt(W))?(e=r.charAt(W),W++):(e=a,0===B&&q(E));return B--,e=a,0===B&&q(M),t}function it(){var t,e;return t=W,B++,r.length>W?(e=r.charAt(W),W++):(e=a,0===B&&q(L)),B--,e===a?t=void 0:(W=t,t=a),t}if((n=u())!==a&&W===r.length)return n;throw n!==a&&W<r.length&&q({type:"end"}),K(G,U<r.length?r.charAt(U):null,U<r.length?$(U,U+1):$(U,U))}}}();function z(t){if(null==t)return{type:"empty_program"};if(Array.isArray(t)){if(0===t.length)throw new Error("Expected an application to have 1 or more items");return 1===t.length?z(t[0]):{type:"application",body:t.map((function(t){return z(t)}))}}if("string"===typeof t)return{type:"name",val:t};if("lambda"===t.type)return{type:"lambda",var:{type:"name",val:t.var},body:z(t.body)};throw new Error("Don't know how to convert program ".concat(JSON.stringify(t)))}function W(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{vars:{},count:0};switch(t.type){case"empty_program":return t;case"name":if(null!=t.boundName)return t;var e=r.vars[t.val];if(e&&e.length>0){var n=e[e.length-1];return C(C({},t),{},{boundName:n})}return t;case"application":return{type:"application",body:t.body.map((function(t){return W(t,r)}))};case"lambda":r.count++;var a=r.count;r.vars[t.var.val]=r.vars[t.var.val]||[];var o=r.vars[t.var.val];o.push(a);var i={type:"lambda",var:C(C({},t.var),{},{boundName:a}),body:W(t.body,r)};return o.pop(),i}throw new Error("Unknown program type ".concat(JSON.stringify(t)))}function H(t){return W(z(function(t){return F.parse(t)}(t)))}var U={parse:function(t){try{return H(t)}catch(r){if(r.format)throw Object.assign({desc:String(r),terminalDesc:r.format([{text:t}])},r);throw r}},evaluate:function t(r){switch(r.type){case"name":case"empty_program":return r;case"lambda":return{type:"lambda",var:r.var,body:t(r.body)};case"application":if(0===r.body.length)throw new Error("Cannot evaluate an empty body");if(1===r.body.length)return t(r.body[0]);var e=r.body[0],n=r.body[1];switch(e.type){case"name":return{type:"application",body:r.body.map((function(r){return t(r)}))};case"lambda":return t({type:"application",body:[I(e.body,e.var,n)].concat(c(r.body.slice(2)))});case"application":return L(e)===L(t(e))?{type:"application",body:[t(e),n].concat(c(r.body.slice(2)))}:t({type:"application",body:[t(e),n].concat(c(r.body.slice(2)))})}}}};h(U);addEventListener("message",(function(r){var e,n=r.data,a=n.type,o=n.method,i=n.id,u=n.params;"RPC"===a&&o&&((e=t[o])?Promise.resolve().then((function(){return e.apply(t,u)})):Promise.reject("No such method")).then((function(t){postMessage({type:"RPC",id:i,result:t})})).catch((function(t){var r={message:t};t.stack&&(r.message=t.message,r.stack=t.stack,r.name=t.name),postMessage({type:"RPC",id:i,error:r})}))})),postMessage({type:"RPC",method:"ready"})}();
//# sourceMappingURL=f4ec22b2e801f4347a4b.worker.js.map